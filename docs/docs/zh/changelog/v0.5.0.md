# `0.5.0` *(2025-05)*

### 问题修复

* **:deep v-bind:** 探寻嵌套组件中的样式为何没有生效, 尝试更换为手工的全链路路径, 最终确认的确是v-bind的问题, 与:deep无关。 并从官方issus中得到确认, 问题确实是由vue本身在v-bind逻辑中的bug所引发。当前存在此bug的vue版本为 3.5.14。 ([5884d26](https://github.com/LuSrackhall/KeyTone/commit/5884d269965b876c799284cad42b7321e235a62c))
* **:style v-bind i18n-ui:** 通过:style定义动态变量, 代替v-bind的使用, 以解决因q-dialog对话框组件独立于.body中而引发的 dialog内部的css动态变量链路无法访问的问题。 :style可直接定义到相关对话框组件的位置, 以允许访问。(当然, 之前猜测的v-bind因不同层级嵌套而无法正常访问链路, 是不准确的, 对v-bind有bug的断言也是太草率了--毕竟直接在当前页面处通过:style定义的动态css变量也存在同样的问题, 只能说v-bind的动态变量可能存在问题。等未来vue的版本更新后, 可检出对应的commit来验证v-bind是否解决了这个问题)(毕竟, 如果v-bind能够起作用, 那它便是最方便的动态css的定义和使用方式) ([bc78086](https://github.com/LuSrackhall/KeyTone/commit/bc78086cea1af577f6081a6afebbdbd1aa53e80d))
* 尝试修复macos下的边框异常问题。 ([0e8c444](https://github.com/LuSrackhall/KeyTone/commit/0e8c44406017d8963af4be518282177a350a9e5f))
* 彻底了sdkIsRun所可能遇到的先有鸡还是现有蛋的问题 -> 得益于新架构下解决了开发环境与生产环境的不一致问题 ([540c68e](https://github.com/LuSrackhall/KeyTone/commit/540c68e06ceeb578d043751a541a4f208a5ead1f))
* 根本性修复macos下的边框异常问题。-> 独立出留出边距以展示阴影的相关样式, 并针对不同平台进行实施。-> 实施对象为非macos平台。 ([5dd129c](https://github.com/LuSrackhall/KeyTone/commit/5dd129ce01a8f61808c241c44cbbd91c2b3e851c))
* 借助之前几次提交中对sdk的server模块启动失败时向终端输出的字符串, 在electron主进程中做相关捕获, 打印相关信息, 并允许继续启动ui。以避免服务模块启动失败的情况下, ui界面显示不出来, 无法告知用户重新启动应用。 ([e328a56](https://github.com/LuSrackhall/KeyTone/commit/e328a56cf927e6f3c4c896b2ce5fc618650ff24b))
* 修复打开应用时获取键音包列表并获取对应名称时因获取失败造成的空白名称问题。(在sdk的相关请求处增加重试次数。经测试,若首次获取失败,往后最多再尝试2次即可成功获取, 而最大重试次数为6。) ([742197e](https://github.com/LuSrackhall/KeyTone/commit/742197ed41d3ace20fddebb09b662b1fe446ef3e))
* 修复了 mac托盘图标菜单中 静音/取消静音 按钮的切换逻辑有明显延迟的问题。-> 将原有的轮询逻辑改为sse主动通知的逻辑, 最大化了实时性。 ([f8aeb04](https://github.com/LuSrackhall/KeyTone/commit/f8aeb049cc30e6ae3b4754ce35108bbc31899322))
* 修复了启动与自启动中基于平台判断时的调用逻辑, 错误的将整个函数作为响应式变量而不是函数的调用结果作为响应式变量, 会使得基于mac平台的判断失效从而引发ui的异常。 ([93e4339](https://github.com/LuSrackhall/KeyTone/commit/93e433940b0dfc878c829e0145059a976be87ad3))
* 修复了首次启动"特指无设置界面配置文件"时, 托盘菜单的 静音/取消静音 按键无法正常使用的bug(但切换语言项后可恢复)。 原因是受到配置文件初始化时, 没有初始化相关字段。 ([dd4d8d9](https://github.com/LuSrackhall/KeyTone/commit/dd4d8d9426dabef89ea121e9f20cfe61304132e2))
* 修复了macos下, 持续在托盘运行的KeyTone可能会阻止系统执行的正常关机和重新启动等操作的bug ([d793693](https://github.com/LuSrackhall/KeyTone/commit/d7936936be21813281f76f9a8698279ea9c8ad9b))
* 修复任务栏顶部的圆角未能生效的问题(尤其是win平台下), 需要手动为任务栏所在元素单独设置圆角相关的样式。 ([d6e0947](https://github.com/LuSrackhall/KeyTone/commit/d6e0947c96fea698d07de85caff4cfcadbed5a89))
* 修复通过ipc获取准确端口号这一新架构下, axios端口号更新不及时造成的启动瞬间异常的bug->当默认端口被占用时便会发生, 在mac上尤为明显。 现将axios中对应端口号的获取增加了立即执行的逻辑, 尽可能第一时间获取最准确的端口信息。 ([b3e4e41](https://github.com/LuSrackhall/KeyTone/commit/b3e4e4121e2b10d397228970fcbb1029ff3679bf))
* 修复mac下, 启动时隐藏窗口的情况下 首次展示窗口时存在的边框异常问题。-> 因为 此问题仅出现在首次展示窗口时, 所以通过对首次展示时进行短暂的隐藏并重新展示的方式来处理。 ([cafd2e2](https://github.com/LuSrackhall/KeyTone/commit/cafd2e291290ffaa77b9d84c2c66e84b6cb9f74e))
* 修复macos下, 因之前修复边框异常问题而新引入的任务栏宽度不够的新bug。 ([9826704](https://github.com/LuSrackhall/KeyTone/commit/982670422884a51dcfa68c327c7cdeefb7f9a268))
* 修复MacOS下, 自动启动的配置无效的bug。 -> 单独使用electron官方的自动启动api来作用于MacOS系统, 以解决此外题。-> 另外, 由于在mas构建下以及 macos版本大于或等于13时自启动时隐藏窗口不可用, 因此在macos下移除此选项 ([4d5da95](https://github.com/LuSrackhall/KeyTone/commit/4d5da955fd4b049211decdb9f4ffab5160b078b2))
* 以略微牺牲启动速度的代价, 保证运行的绝对稳定, 不出现任何sdk启动不及时的问题。(生产环境中, 只有在遇到sdk启动不及时的情况下->这种情况常在更开机的几分钟内概率较高其它情况概率很低, 才会略微降低启动速度) ([9dd4d63](https://github.com/LuSrackhall/KeyTone/commit/9dd4d6354f8722af211caef674c8b34d335c76d8))
* 优化键音专辑组件中, 所有选择框(无论是否带芯片,无论单选或多选)的溢出滚动样式 ([394ade2](https://github.com/LuSrackhall/KeyTone/commit/394ade22fe04534485bc7732bf4ef96b7cdac966))
* **i18n-RTL:** 本次修复, 完全规避了潜在的可能因 语言字母简写 不受支持而报错的问题, 无论怎样,最终都会切换到 i18n/index.ts中定义的受支持的类型, i18n/index.ts中的定义也是判断的唯一依据。 ([63ca266](https://github.com/LuSrackhall/KeyTone/commit/63ca266eee44a6b7a0b980a9e153b373972cbf53))
* **i18n-RTL:** 修复RTL模式下, 部分按钮的位置不正确的问题。 ([63e7498](https://github.com/LuSrackhall/KeyTone/commit/63e7498674cc8b528b3f016724c152e9966ddf7f))
* **i18n-RTL:** 修复RTL模式下, 部分带箭头图标按钮没有旋转180度的问题, 本次修复通过手动处理相关样式进行按需旋转来解决。 ([b916554](https://github.com/LuSrackhall/KeyTone/commit/b916554979f1289019e5b72874803d05940d5b46))
* **i18n-ui:** 本次ui修复利用v-bind引入动态的字体尺寸, 以针对不同语言的i18n来适配对应的字体尺寸。本次修复之前多次对i18n的ui样式更改, 始终未获得合适的统一字体尺寸(总有语言字体过大或表达语句过长而影响布局), 因此有了本次修复。 ([319d1e9](https://github.com/LuSrackhall/KeyTone/commit/319d1e91ca81ef09273f612c4d512f9bc3fc0130))
* **i18n-ui:** 为i18n下各语言的ui界面, 做进一步的优化适配。 ([12630f3](https://github.com/LuSrackhall/KeyTone/commit/12630f3e3e5486ca1bc7776adb17fb355b9265f1))
* **i18n-ui:** 针对macos优化了步骤说明的字体大小样式 ([84029bd](https://github.com/LuSrackhall/KeyTone/commit/84029bd077edef095bc75e5c053b0ac377856d9b))
* **i18n-ui:** 针对windows优化了步骤说明的字体大小样式 ([2a275e2](https://github.com/LuSrackhall/KeyTone/commit/2a275e2f4c91d4f0614fe7565946d22f1670f84f))
* **i18n:** 修复法语i18n中, 不正确的内容。 ([5cb2c86](https://github.com/LuSrackhall/KeyTone/commit/5cb2c86a6737ec417080e2bd72e098e6f4ba1059))
* **i18n:** 修复了之前i18n对于主页license的介绍仅能覆盖到中英文的问题, 本次修复使其可以覆盖到整个i18n的配置 ([8b3459f](https://github.com/LuSrackhall/KeyTone/commit/8b3459f16e79becb31ec975296ef5874046a40c3))
* **i18n:** 修复葡萄牙、葡萄牙语(巴西)i18n中, 会引发ui布局异于默认布局的内容 ([d02b4e1](https://github.com/LuSrackhall/KeyTone/commit/d02b4e13860ff76335862b0aac5378239dca2688))
* **i18n:** 修复西班牙语i18n中, 会引发ui布局异于默认布局的内容 ([7c0e914](https://github.com/LuSrackhall/KeyTone/commit/7c0e91443514aa4e5a2d6b7980f815712aa0712d))
* **i18n:** 修复i18n适配过程中, 意外更改key的问题。已全部还原。 ([6898730](https://github.com/LuSrackhall/KeyTone/commit/689873098ee3b39d39fa2f7975569c9283b7a862))
* **i18n:** 修复i18n为俄语时的展示效果, 使其布局效果与默认的尽量保持一致。 ([815b4de](https://github.com/LuSrackhall/KeyTone/commit/815b4de6b6cbda84297c1dfb825e2bc95f36329f))
* **macos-ui:** 修复了macos下页面居中偏左的问题。 ([4f052e7](https://github.com/LuSrackhall/KeyTone/commit/4f052e7da59fd348a52fed443774f27be0bc85ed))
* **macos-ui:** 修复macos下各界面ui宽度的基础尺寸, 使其更合理。(win版本也存在此问题-379px应改为381.2px, 不过由于历史原因可能已在页面内部基于各个组件做了相关适配工作, 因此仅为代码沉余, 对整体ui无影响, 故暂时无需处理) ([e5aecf1](https://github.com/LuSrackhall/KeyTone/commit/e5aecf154c1f6e9ca711b2e587678614e9832a10))
* **sdk:** 本次修复是为了避免极小概率出现的因请求本身错误而造成的端口号输出受影响的情况, 不过这个几率是微乎其微的, 所以本次修复并不重要。 ([2579bde](https://github.com/LuSrackhall/KeyTone/commit/2579bde0e88168671fe97b45618f4c8843a05398))
* **sdk:** 尝试修复 导出/导入 键音专辑时的跨平台一致性, 防止出现从win平台导出的专辑, 无法在mac和linux平台的设备上导入的问题。具体原因看详情。 ([f9f8d1a](https://github.com/LuSrackhall/KeyTone/commit/f9f8d1aff04307507441dd466b19434b793f77a0))
* **sdk:** 从sdk级别避免因至臻键音继承过程中的无限循环依赖而引发的cup负载过高 或 内存占用过多的内存溢出 等风险。本次修复的处理方式, 是在sdk核心层增设了继承嵌套层级最大为1000层的限制(因为不可能有人去制作超过1000层继承嵌套级别的键音)。 ([5e0a8ac](https://github.com/LuSrackhall/KeyTone/commit/5e0a8ac1c10cdd92fabcfc543396b24ee11e2588))
* **sdk:** 进一步简化了sdk处理端口号返回时机的相关逻辑 ([e9e30fb](https://github.com/LuSrackhall/KeyTone/commit/e9e30fb60de20688c568377c82949f105fe5bc3a))
* **sdk:** 为保证sdk输出所用端口号时, 相关server服务可用, 本次提交做了相关处理, 使得服务启动成功后, 才返回端口号。 ([71d434c](https://github.com/LuSrackhall/KeyTone/commit/71d434c91c982a1fefe250f2dbf9c5c950cd551d))
* **ui:** 继续修复设置页面因i18n不同长度引起的按钮及页面布局异常的问题 ([21f15b9](https://github.com/LuSrackhall/KeyTone/commit/21f15b91db317adf1600ee8f866a8e40ed4dc773))
* **ui:** 进一步修复在设置页面中的部分ui问题。即因i18n中不同语言字符串的长度问题造成的ui布局异常的bug, 现已得到修复 ([11c7251](https://github.com/LuSrackhall/KeyTone/commit/11c725173ca3ee98bd8f03aede05cf3102d4fbd1))
* **ui:** 全面禁用键音专辑页面选择器组件自带的虚拟滚动, 以避免影响用户体验。 ([197df0a](https://github.com/LuSrackhall/KeyTone/commit/197df0ad0fbcfb65354287fc1a425dd9472b5541))
* **ui:** 修复侧边栏展开后任务栏与整体ui不协调的问题 ([7737ba4](https://github.com/LuSrackhall/KeyTone/commit/7737ba4791eedc88de227f7493bc1b0aad5ccde3))
* **ui:** 修复各个页面内选择器组件的label名称过长时溢出不显示(或显示滚动条)的问题。(比如俄语就比较长,容易观察到此现象) ([e1974b5](https://github.com/LuSrackhall/KeyTone/commit/e1974b5c74cee60ba6c7116e31a192df1a5ae9a3))
* **ui:** 修复键音专辑页面, 展开按钮位置部分与任务栏重合的问题。 ([bb85ca3](https://github.com/LuSrackhall/KeyTone/commit/bb85ca3f079cf4cdf9feba15aa1aecd76ebf0077))
* **ui:** 修复键音专辑组件中, 裁剪定义声音步骤中, 定义新声音的弹窗底部按钮贴合太近的问题。 ([8d474a4](https://github.com/LuSrackhall/KeyTone/commit/8d474a4e9a921578d1c702f01276eab9f3874f48))
* **ui:** 修复了进入设置页面时的界面溢出问题, 以及修复了侧边栏弹出后的契合度问题 ([626ecf8](https://github.com/LuSrackhall/KeyTone/commit/626ecf8d4bfa22b6fa01e215913a62272d24b3fc))
* **ui:** 修复了设置页面展开图标处的动画闪烁问题。(会在展开瞬间短暂的出现滚动条样式) ([428a1ea](https://github.com/LuSrackhall/KeyTone/commit/428a1ea43359f0036149c948640879e74fb0c586))
* **ui:** 修复了主页面因键音专辑名称过长而造成的界面溢出等异常问题; 还修复了 主页面和键音专辑页面 中, 键音专辑选择框中对于名称过长键音专辑的 滚动效果丢失的bug,本次修复使其重新生效。 ([d8ade1c](https://github.com/LuSrackhall/KeyTone/commit/d8ade1c7a02536134ecb25126301d4cfb381bbd4))
* **ui:** 修复引入更多语言后, 因不同语言表达的字符串长度不同, 造成ui层面主要页面布局异常的bug, 本次主要修复了因按钮ui异常所引发整体观感不佳的问题。 ([1419d97](https://github.com/LuSrackhall/KeyTone/commit/1419d97793c644e7cd223dd871e11e4ed2a83ab5))


### 新特性

* **i18n-RTL:** 为阿拉伯类的i18n适配提供进一步的RTL适配。涉及到RTL相关插件的配置, 和动态切换quasar语言包的配置, 以及最终取出语言包内容并动态设置语言包的相关逻辑 ([e5bbd7f](https://github.com/LuSrackhall/KeyTone/commit/e5bbd7f8667aab5cbe5af3e358c729f729d29ec3))
* **i18n:** 新增语言选择框为多国同语种语言, 双向适配单一的语言列表项的功能。 此功能解决了i18n应用场景下关于选择列表中 多国同语种 的一个 列表项重复 难题。 ([2137794](https://github.com/LuSrackhall/KeyTone/commit/2137794fe05911a99ce2515c0c4ca95795e48ee4))
* **i18n:** 支持阿拉伯语(符合msa标准), 但目前暂无RTL支持 ([5f53067](https://github.com/LuSrackhall/KeyTone/commit/5f53067df0ea77762b4eb50def1483a99c1618f8))
* **i18n:** 支持波兰语 ([7c40a02](https://github.com/LuSrackhall/KeyTone/commit/7c40a023f88fe4048795a2e04c728280661facdb))
* **i18n:** 支持德语 ([4c9f046](https://github.com/LuSrackhall/KeyTone/commit/4c9f046366d868edc5cecfa2b17075045c930ba0))
* **i18n:** 支持俄语 ([fc72e3f](https://github.com/LuSrackhall/KeyTone/commit/fc72e3f2c889555beea48bd59a8f48a19cd58ffd))
* **i18n:** 支持法语 ([7dbc683](https://github.com/LuSrackhall/KeyTone/commit/7dbc683e3f9c227da86d78d72c48aa837dde4163))
* **i18n:** 支持韩语 ([d15898b](https://github.com/LuSrackhall/KeyTone/commit/d15898b8ab448b9848b94513f0cfaacd2c24e30d))
* **i18n:** 支持葡萄牙语, 葡萄牙语(巴西) ([06b9e97](https://github.com/LuSrackhall/KeyTone/commit/06b9e97b27783e34ec4e81ec5abbe84cb36e3cd7))
* **i18n:** 支持日语 ([4334c1e](https://github.com/LuSrackhall/KeyTone/commit/4334c1e95bf79ce092f3d81cdcc939880b2cad42))
* **i18n:** 支持土耳其语 ([1441f2b](https://github.com/LuSrackhall/KeyTone/commit/1441f2bb2cfe0773f96e0587f76114ca33a37e46))
* **i18n:** 支持西班牙语 ([ffd9aa4](https://github.com/LuSrackhall/KeyTone/commit/ffd9aa4ab3aacddecb8e8acd1ae4b33f40c2c3ef))
* **i18n:** 支持意大利语 ([8ffa24d](https://github.com/LuSrackhall/KeyTone/commit/8ffa24d8ce3bb5933d15803e79e0a170a7e500c0))
* **i18n:** 支持印尼语 ([bbd9262](https://github.com/LuSrackhall/KeyTone/commit/bbd9262e9173826b049138a9b88165f1265ead0d))
* **i18n:** 支持越南语 ([7b936b4](https://github.com/LuSrackhall/KeyTone/commit/7b936b4daf91c36451b192d4e92185795555349f))
* **i18n:** 支持中文繁体。 ([36f7f8f](https://github.com/LuSrackhall/KeyTone/commit/36f7f8fb20361f7400ebe66d3e660ab72bca5aa0))
* **ui:** 更改版本号的展示条件, 改为仅在主页面时展示版本号 ([467bca4](https://github.com/LuSrackhall/KeyTone/commit/467bca4fb31c21543b65c06ab51d3d88cd08ae18))
* **ui:** 适配macos平台下任务栏关闭/最小化等按钮的默认习惯, 移除macos平台下任务栏右侧与win平台下一致的最小化和关闭按钮, 并为适配左侧mac原生的关闭最小化按钮而向右平移任务栏其它功能按钮。 ([bc37bad](https://github.com/LuSrackhall/KeyTone/commit/bc37badd4eca875b57600d122775a7e93d1c782a))
* **ui:** 移除了步骤条中原有的依赖step数来确认是否完成的逻辑, 并新增了根据简单的是否操作过的判断来确认是否完成的逻辑 ([2621efb](https://github.com/LuSrackhall/KeyTone/commit/2621efb98f272d167b9beca982139a645a289fd2))
* **ui:** 在键音专辑页面, 新增了帮助按钮, 点击后会打开键音专辑介绍页的文档网址。 ([1dd23fa](https://github.com/LuSrackhall/KeyTone/commit/1dd23fa505d729b937a9c4310063e02ef5f2bc6f))


### 还原

* Revert "Revert "fix: 修复打开应用时获取键音包列表并获取对应名称时因获取失败造成的空白名称问题。(在sdk的相关请求处增加重试次数。经测试,若首次获取失败,往后最多再尝试2次即可成功获取, 而最大重试次数为6。)" -> 原因是, 引发这个问题的真正原因是 axios的端口号没能及时更新为真实端口号, 而不是之前所认为的viper的加载成功后的不稳定因素。" -> 原因最终定性, 这个bug与端口号是否即时更新无关, 真正原因就是一开始叙述的内容, 是sdk中的相关逻辑诱发的(跟获取键音包名称函数的逻辑中viper初始化的不稳定性有关, 但viper的问题太棘手--或者说这个viper到处都是问题--就不配有如此高的star, 最终我只能在自己的应用层提高可靠性来达到修复此问题的目的)。 ([6c7bf68](https://github.com/LuSrackhall/KeyTone/commit/6c7bf689c159c5e876f488e931c50724d4f45f11))
* Revert "test(debug): 本次提交只为debug首次启动时所选的键音包的名称异常显示为空白的问题。经过本次测试发现, 与端口号的即时性无关, 即便使用的是默认的38888端口号也存在此问题。经过前端axios的返回值发现, 请求的错误是500->即这个错误是服务端相关api内部的逻辑问题。 我们的正确请求是没有问题的, 不管是端口号还是参数; 出问题的是sdk中的api内部逻辑。" ([886183d](https://github.com/LuSrackhall/KeyTone/commit/886183d3a46227c9ba552a368d12f37f330c638e))
* Revert "fix: 修复mac下, 启动时隐藏窗口的情况下 首次展示窗口时存在的边框异常问题。-> 因为 此问题仅出现在首次展示窗口时, 所以通过对首次展示时进行短暂的隐藏并重新展示的方式来处理。"  -> 这个bug的真正原因是, electron框架太过落后, 升级electron框架版本后, 不再有此问题。 ([174eba5](https://github.com/LuSrackhall/KeyTone/commit/174eba576f8c5fb4a8c93a4aab8d6932750b5bda))
* Revert "fix: 修复打开应用时获取键音包列表并获取对应名称时因获取失败造成的空白名称问题。(在sdk的相关请求处增加重试次数。经测试,若首次获取失败,往后最多再尝试2次即可成功获取, 而最大重试次数为6。)" -> 原因是, 引发这个问题的真正原因是 axios的端口号没能及时更新为真实端口号, 而不是之前所认为的viper的加载成功后的不稳定因素。 ([2d40b76](https://github.com/LuSrackhall/KeyTone/commit/2d40b760bc5cbc17e0fe65bb1523dbdaff7a835e))