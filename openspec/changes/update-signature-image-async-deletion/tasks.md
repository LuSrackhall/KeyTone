# 任务清单

## 目标

实现“删除签名先重命名图片标记（`Delete___` 前缀），启动清理按文件名删除 Delete___*”的异步删除机制，避免密钥变更导致误删。

## 任务

1. 更新签名管理规格（spec delta）
   - 修改“删除签名”与“清理孤立图片”两条 Requirement 的规范性描述与场景。

2. 后端：删除签名流程调整
   - 在 `POST /signature/delete` 中：删除配置前尝试对图片做 `os.Rename` 标记。
   - 重命名失败返回错误，且不删除配置条目。

3. 后端：启动清理逻辑调整
   - 将 `CleanupOrphanCardImages` 改为只删除 `ConfigPath/signature` 下文件名以 `Delete___` 开头的文件。

4. 日志与可观测性
   - 删除接口：记录重命名目标与失败原因。
   - 启动清理：记录删除数量。

5. 验证
   - 手工验证场景：
       - 密钥变更后启动：非 Delete___ 文件不被删除。
       - 删除带图片签名：图片被重命名为 Delete___*；启动后被删除。
       - 模拟重命名失败：删除接口返回失败，配置未变。
   - 逻辑核对：创建/更新/导入流程不会生成“多签名共享同一图片文件”（文件名含 id 与时间戳，不做内容去重）。

## Checklist

- [x] 1. 更新签名管理规格（spec delta）
- [x] 2. 后端：删除签名流程调整
- [x] 3. 后端：启动清理逻辑调整
- [x] 4. 日志与可观测性
- [x] 5. 验证（按上述手工场景执行）

